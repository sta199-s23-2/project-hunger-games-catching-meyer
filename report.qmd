---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

### Introduction and Data

[INTRODUCTION]{.underline}

Figure skating is a sport in which athletes complete programs full of jumps, spins, and footwork while making sure to perform to their music. Scoring for figure skating consists of two components, the technical score and the artistic score. And it's this scoring that is the source of much of the controversy in the figure skating world.

In recent years, women's figure skating has experienced a "quad revolution" of sorts, with female skaters beginning to perform quadruple jumps with a higher frequency. This has been met with many questions, from fans, coaches, and authorities alike. Are quadruple jumps -- where the skater rotate four revolutions in the air -- valued too heavily? Are they leading to degradation in the performance of other elements?

One of the skaters that helped bring this revolution about is Alexandra Trusova, a Russian figure skater whose national and international competitive career spanned from 2014 to 2022. She was the first to perform several types of quadruple jumps in competition, and her earlier competitive years are well documented. Thus, she is a prime subject for analysis.

[THE DATA]{.underline}

Our data is collected from the competition records of the International Skating Union, Tallinn Trophy, and the Russian Skating Federation. The International Skating Union (ISU) is the governing body of figure skating competition around the world. ISU-sanctioned and many other competitions have websites containing records of the detailed results of the competition. Each event has an attached pdf file, recording every skater's detailed scoring breakdown, including the judges' evaluation of their jumps. After obtaining Alexandra Trusova's competitive history, the corresponding data for each of her jumps completed in national championships or international competition was pulled into a dataset, accompanied by relevant data about date and the competition location.

[RELEVANT VARIABLES]{.underline}

Table of relevant variables

[ETHICAL CONCERNS]{.underline}

Despite her fame within the figure skaitng world, Alexandra Trusova was a minor during the time period this dataset covers. As such, the only data we gathered was taken from publicly available records. We also took care to not include variables that evaluated Trusova's skating in a subjective manner and kept our analysis to quantitative data when possible.

[RESEARCH QUESTION & HYPOTHESIS]{.underline}

With this dataset, we are researching how the difficulty of the jump and the location of the competition affect Alexandra Trusova's execution of jumps. Through this, we seek to find patterns in Trusova's jump data that support or do not support the questions surrounding quadruple jumps in women's figure skating. We hypothesize that increases in difficulty of the jump, distance between training location and competition location, and altitude of the competition will negatively affect Trusova's execution of her jumps.

### Methodology

```{r}
#| label: load-pkgs
#| message: false

library(tidyverse)
library(tidymodels)


trusova_jump <- read.csv("data/trusova_jumps.csv")

```

[HYPOTHESIS TESTS]{.underline}

```{r}
#| label: jump difficulty hypothesis test

jump_difficulty <- trusova_jump |>
  arrange(jump_bv)|>
  drop_na(goe_raw) |>
  mutate(jump_group = ifelse(row_number() <= n()/2, "easy_jumps", "hard_jumps"))

difficulty_means <- jump_difficulty |>
  group_by(jump_group) |>
  summarize(mean_goe_raw = mean(goe_raw),
            n = n())

difficulty_means
```

-   **Null:** The difficulty of the jump has no significant effect on the execution of the jump.

-   **Alternate:** The difficulty of the jump affects the execution of the jump. As the difficulty of the jump increases, the execution of the jump, as defined by the raw goe, decreases.

```{r}
summary(lm(goe_raw ~ jump_bv, data = jump_difficulty))
```

```{r}
null_dist_jump <- jump_difficulty |>
  specify(response = goe_raw, explanatory = jump_group) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("easy_jumps", "hard_jumps"))

null_dist_jump |>
  ggplot(
    aes(x = stat)
  ) + 
  geom_histogram() + 
  geom_vline(xintercept = 0.356138) +
  geom_vline(xintercept = -0.356138)

null_dist_jump |>
  get_p_value(obs_stat = 0.356138, direction = "two sided")
```

The probability of observing our sample statistic, or something more extreme, given that the true (population) difference between the mean raw score of jumps is 0.356138, is equal to \~ 0.352.

alpha = 0.05 \< p-value 0.352. Failing to reject our null hypothesis. Weak evidence to conclude the alternative hypothesis.

```{r}
#| label: altitude hypothesis test

altitude_filter <- trusova_jump |>
  arrange(altitude_in_m)|>
  drop_na(goe_raw) |>
  mutate(alt_group = ifelse(row_number() <= n()/2, "low_altitude", "high_altitude"))

altitude_means <- altitude_filter |>
  group_by(alt_group) |>
  summarize(mean_goe_raw = mean(goe_raw),
            n = n())

altitude_means
```

-   **Null:** The altitude of the competition location has no significant effect on the execution of the jump.

-   **Alternate:** The altitude of the competition location relative to Moscow affects the execution of the jump. As the altitude of the competition location relative to Moscow increases, the execution of the jump, as defined by the raw goe, decreases.

```{r}
null_dist_alt <- altitude_filter |>
  specify(response = goe_raw, explanatory = alt_group) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("low_altitude", "high_altitude"))

null_dist_alt |>
  ggplot(
    aes(x = stat)
  ) + 
  geom_histogram() + 
  geom_vline(xintercept = 0.605648) +
  geom_vline(xintercept = -0.605648)

null_dist_alt |>
  get_p_value(obs_stat = 0.605648, direction = "two sided")
```

The probability of observing our sample statistic, or something more extreme, given that the true (population) difference between the mean raw score of jumps is 0.605648, is equal to \~ 0.07.

alpha = 0.05 \< p-value 0.07. Failing to reject our null hypothesis. Weak evidence to conclude the alternative hypothesis.

```{r}
#| label: distance hypothesis test

distance_filter <- trusova_jump |>
  arrange(distance_moscow_km)|>
  drop_na(goe_raw) |>
  mutate(dist_group = ifelse(row_number() <= n()/2, "short_distance", "long_distance"))

distance_means <- distance_filter |>
  group_by(dist_group) |>
  summarize(mean_goe_raw = mean(goe_raw),
            n = n())

distance_means
```

-   **Null:** The distance of the competition location from Moscow has no significant effect on the execution of the jump.

-   **Alternate**: As the distance between Moscow and the competition location increases, the execution of the jump, as defined by the raw goe, decreases.

```{r}
null_dist_dist <- distance_filter |>
  specify(response = goe_raw, explanatory = dist_group) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("short_distance", "long_distance"))

null_dist_dist |>
  ggplot(
    aes(x = stat)
  ) + 
  geom_histogram() + 
  geom_vline(xintercept = 0.603055) +
  geom_vline(xintercept = -0.603055)

null_dist_dist |>
  get_p_value(obs_stat = 0.603055, direction = "two sided")
```

The probability of observing our sample statistic, or something more extreme, given that the true (population) difference between the mean raw score of jumps is 0.603055, is equal to \~ 0.068.

alpha = 0.05 \< p-value 0.068. Failing to reject our null hypothesis. Weak evidence to conclude the alternative hypothesis.
[GRAPHS] {.underline}
```{r}
#| label: difficulty-score-comparison
trusova_jump |> 
  ggplot(aes(x = jump_bv, y = goe_raw, color = jump)) + 
  geom_point() + 
  geom_smooth() + 
  facet_wrap("competition") + 
  labs(title = "Relationship Between Jump Difficulty and Score", 
       subtitle = "By Competition", 
       x = "Difficulty of Jump", 
       y = "Score", 
       color = "Type of Jump") + 
  theme_minimal()
```
```{r}
#| label: distance-score-comparison
trusova_jump |> 
  ggplot(aes(x = distance_moscow_km, y = goe_raw, color = jump_bv)) + 
  geom_point() + 
  geom_smooth() + 
  labs(title = "Relationship Between Distance Travelled and Score", 
       x = "Distance of Competition From Moscow", 
       y = "Score", 
       color = "Difficulty of Jump") + 
  theme_minimal()
```
```{r}
trusova_jump |> 
  ggplot(aes(x = altitude_in_m, y = goe_raw, color = jump_bv)) + 
  geom_point() + 
  geom_smooth() + 
  geom_vline(xintercept = 156) + 
  labs(title = "Relationship Between Altitude and Score", 
       x = "Altitude with Line Drawn at Moscow", 
       y = "Score", 
       color = "Difficulty of Jump") + 
  theme_minimal()
```


[PREDICTIVE MODELS]{.underline}

```{r}
#| label: predictive model with only difficulty

difficulty_model <- linear_reg() |>
   set_engine("lm") |>
   fit(goe_raw ~ jump_bv, data = trusova_jump) 

glance(difficulty_model)$adj.r.squared

glance(difficulty_model)$AIC

```

```{r}
#| label: predictive model with only altitude
altitude_model <- linear_reg() |>
   set_engine("lm") |>
   fit(goe_raw ~ altitude_in_m, data = trusova_jump)

glance(altitude_model)$adj.r.squared

glance(altitude_model)$AIC

```

```{r}

#| label: predictive model with only distance

distance_model <- linear_reg() |>
   set_engine("lm") |>
   fit(goe_raw ~ distance_moscow_km, data = trusova_jump)

glance(distance_model)$adj.r.squared

glance(distance_model)$AIC


```

```{r}
#| label: Altitude and Difficulty of Jump

dif_alt_model <- linear_reg() |>
  set_engine("lm") |>
  fit(goe_raw ~ jump_bv + altitude_in_m, data = trusova_jump) 

glance(dif_alt_model)$adj.r.squared
		
glance(dif_alt_model)$AIC

```

```{r}
#| label: Model with Distance and Difficulty of Jump
	
dd_model <- linear_reg() |>
  set_engine("lm") |>
  fit(goe_raw ~ jump_bv + distance_moscow_km, data = trusova_jump) 

glance(dd_model)$adj.r.squared
		
glance(dd_model)$AIC

```

```{r}
#| label: Model with Altitude and Distance

alt_dist_model <- linear_reg() |>
  set_engine("lm") |>
  fit(goe_raw ~ altitude_in_m + distance_moscow_km, data = trusova_jump) 

glance(alt_dist_model)$adj.r.squared
		
glance(alt_dist_model)$AIC

```

```{r}
#| labe;: Model with Altitude and Distance and Difficulty of Jump

combined_model <- linear_reg() |>
  set_engine("lm") |>
  fit(goe_raw ~ jump_bv + altitude_in_m + distance_moscow_km, data = trusova_jump) 

glance(combined_model)$adj.r.squared

glance(combined_model)$AIC

```

### Results

### Conclusion

Paragraph responding to results.

Although our data is reliable due to it being gathered from official competition records, to increase the validity of our claims we would need to gather the same information for more female skaters performing quadruple jumps over their entire careers. Due to how few female skaters have performed numerous types of quads over many years of their career, it was simply not possible to gather data for a large sample of skaters. As such, the conclusions we've drawn regarding Alexandra Trusova's jumps and performance cannot be generalized to the sport of figure skating as a whole until it can be supported by data gathered from the careers of other skaters.
